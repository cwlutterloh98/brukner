!function(e){"use strict";var t=[];function n(){var e=!1,n=this,r=function(e,t){var n=e.nextElementSibling.getAttribute("aria-label"),r=e.parentElement.querySelector('[aria-checked="true"]');"true"===e.getAttribute("aria-expanded")||!r||t?e.textContent=n:r&&(e.innerHTML=r.textContent+'<span class="sr-only">, '+n+"</span>")},i=function(e){var t=e.target,n=t.nextElementSibling,i="true"===t.getAttribute("aria-expanded"),a=t.parentElement.querySelector('[aria-checked="true"]');e.preventDefault(),"click"!==e.type&&"keydown"!==e.type&&(i=!1),t&&n&&(t.setAttribute("aria-expanded",i?"false":"true"),n.setAttribute("aria-hidden",i?"true":"false"),e&&e.keyCode&&!i&&(a?a.focus():n.querySelector("li:first-child a").focus())),"true"===t.getAttribute("data-select")&&r(t)},a=function(e,t){var n=t?[t]:document.querySelectorAll('.bb-dropdowns > li > a[aria-haspopup="true"]:not([data-clickonly])');Array.prototype.forEach.call(n,function(t){t.getAttribute("data-select")&&(t.getAttribute("data-clickonly")||"mouseleave"===e.type)||(t.nextElementSibling.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false")),"true"===t.getAttribute("data-select")&&r(t)})},o=function(e){var t=e.target.parentElement.parentElement;setTimeout(function(){"false"!==t.getAttribute("aria-hidden")||t.contains(document.activeElement)||a(e,t.previousElementSibling)},100)},l=function(e){var t,n="true"===e.target.getAttribute("data-select");32===e.keyCode||13===e.keyCode||40===e.keyCode||38===e.keyCode?(e.preventDefault(),i(e)):37!==e.keyCode&&39!==e.keyCode||n||(e.preventDefault(),(t=37===e.keyCode?e.target.parentElement.previousElementSibling:e.target.parentElement.nextElementSibling)&&(a(e,e.target),t.firstElementChild.focus()))},u=function(e,t,n){var r,i,a,o=e?e.target:n,l=t,u=!1;Array.prototype.forEach.call(t.parentElement.querySelectorAll("li > a"),function(e){"true"===e.getAttribute("aria-checked")&&(r=e.textContent),e.removeAttribute("aria-checked")}),o.blur(),o.setAttribute("aria-checked","true"),l.setAttribute("data-value",o.getAttribute("data-value")?o.getAttribute("data-value"):""),r&&r===o.textContent||(l.textContent=o.textContent,u=!0),n||l.click(),!n&&u&&(i=l,(a=document.createEvent("Event")).initEvent("change",!0,!0),i.dispatchEvent(a)),e&&"click"!==e.type&&l.focus()},d=function(e){var t,n,r,i=document.querySelector('.bb-dropdowns > li > a[aria-expanded="true"]'),a="menuitemradio"===e.target.getAttribute("role");return(27===e.keyCode||32===e.keyCode&&!a)&&i?(e.preventDefault(),i.click(),i.focus()):38===e.keyCode?(e.preventDefault(),(t=e.target.parentElement.previousElementSibling||e.target.parentElement.parentElement.lastElementChild)&&t.firstElementChild.focus()):40===e.keyCode?(e.preventDefault(),(n=e.target.parentElement.nextElementSibling||e.target.parentElement.parentElement.firstElementChild)&&n.firstElementChild.focus()):37!==e.keyCode&&39!==e.keyCode||!i||a?a&&9===e.keyCode?e.preventDefault():(13===e.keyCode||32===e.keyCode||"click"===e.type&&"A"===e.target.tagName&&i)&&(a?(e.preventDefault(),u(e,i)):i.click()):(e.preventDefault(),(r=37===e.keyCode?i.parentElement.previousElementSibling:i.parentElement.nextElementSibling)&&(i.click(),r.firstElementChild.focus())),!0},c=function(e){var t=document.querySelectorAll('.bb-dropdowns > li > a[aria-expanded="true"]');Array.prototype.forEach.call(t,function(t){t===e.target||t.nextElementSibling.contains(e.target)||a(e,t)})},s=function(e){e.forEach(function(e){var t,n="true"===e.getAttribute("data-select");e.style.minWidth=null,t=e.offsetWidth,n&&(e.style.minWidth=t+"px"),e.nextElementSibling.style.minWidth=t>160?t+"px":null})},f=new MutationObserver(function(e){e.forEach(function(e){(e.removedNodes.length||e.addedNodes.length)&&n.init(e.target.previousElementSibling)})});this.initialized=Boolean(t.length),this.resetSelect=function(e){var n=e?document.querySelector(e):null;if(!n)throw new Error("Element could not be found!");if(-1===t.indexOf(n)||"true"!==n.getAttribute("data-select"))throw new Error("Element not initialized or not a select!");r(n,!0),n.removeAttribute("data-value"),Array.prototype.forEach.call(n.parentElement.querySelectorAll("li > a"),function(e){e.removeAttribute("aria-checked")})},this.init=function(n){var p,m=n?[n]:document.querySelectorAll(".bb-dropdowns > li > a"),E=!1,b={childList:!0};Array.prototype.forEach.call(m,function(e){var c,s=e.nextElementSibling;(-1===t.indexOf(e)||n)&&s&&(p="true"===e.getAttribute("data-select"),e.setAttribute("aria-haspopup","true"),e.setAttribute("role","button"),n||(e.addEventListener("click",i,!1),e.addEventListener("focus",a,!1),e.addEventListener("keydown",l,!1),s.addEventListener("keydown",d,!1),s.addEventListener("focusout",o,!1),s.addEventListener("click",d,!1),s.setAttribute("aria-label",e.textContent+(p?"":" submenu")),"true"===e.getAttribute("data-clickonly")||p?E=!0:(e.addEventListener("mouseover",i,!1),e.parentElement.addEventListener("mouseleave",a,!1))),p&&(c=e.offsetWidth,e.removeAttribute("data-value"),e.parentElement.parentElement.setAttribute("role","presentation"),e.style.minWidth=c+"px",s.setAttribute("role","menu"),n||f.observe(s,b),Array.prototype.forEach.call(s.querySelectorAll("li > a"),function(t){t.setAttribute("role","menuitemradio"),t.parentElement.setAttribute("role","presentation"),"true"===t.getAttribute("aria-checked")&&u(null,e,t),r(e)})),t.push(e))}),s(t),this.initialized||(E&&document.addEventListener("click",function(e){c(e)}),window.addEventListener("resize",function(){s(t)}),document.addEventListener("touchmove",function(){e=!0}),document.addEventListener("touchstart",function(){e=!1}),document.addEventListener("touchend",function(t){e||c(t)}),document.body.classList.remove("no-js"),this.initialized=!0)}}"undefined"!=typeof module&&void 0!==module.exports?module.exports=n:"function"==typeof define&&define.amd?define("BbDropdowns",[],function(){return n}):"object"==typeof e&&(e.BbDropdowns=n)}(this);